# Auto-generated by the Cortex Python SDK

FROM {{base_image}}

WORKDIR /job

RUN apt-get update && apt-get install -y linux-headers-amd64 build-essential

RUN conda config --add channels conda-forge

COPY conda_requirements.txt .
RUN conda install --yes --file conda_requirements.txt

RUN pip install "dill==0.2.8.2" "cortex-client=={{cortex_sdk_version}}"

COPY requirements.txt .
RUN pip install -r requirements.txt

{% if deploy_archive %}
COPY action.tar .
RUN tar xf action.tar --strip 1
{% endif %}

COPY action.py .

ENTRYPOINT ["python", "action.py"]
