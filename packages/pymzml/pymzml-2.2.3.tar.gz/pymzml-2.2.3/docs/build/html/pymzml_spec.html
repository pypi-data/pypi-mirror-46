

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>3.2. Spectrum and Chromatogram &mdash; pymzML 2.0.6 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="3.3. Utils" href="pymzml_utils.html" />
    <link rel="prev" title="3.1. Main reader interface" href="pymzml_run.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> pymzML
          

          
          </a>

          
            
            
              <div class="version">
                2.0.6
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="quick_start.html">2. Quick Start</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">3. pymzML module content</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="pymzml_run.html">3.1. Main reader interface</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">3.2. Spectrum and Chromatogram</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#spectrum">3.2.1. Spectrum</a></li>
<li class="toctree-l3"><a class="reference internal" href="#chromatogram">3.2.2. Chromatogram</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ms-spectrum">3.2.3. MS_Spectrum</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pymzml_utils.html">3.3. Utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot.html">3.4. Plotting functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="file_handlers.html">3.5. File Access</a></li>
<li class="toctree-l2"><a class="reference internal" href="obo.html">3.6. OBO parser</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymzml_regex_patterns.html">3.7. Regex patterns</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">4. Examples and Advanced Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="suppl_material.html">5. Supplemental Material</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pymzML</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="modules.html">3. pymzML module content</a> &raquo;</li>
        
      <li>3.2. Spectrum and Chromatogram</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/pymzml_spec.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-pymzml.spec">
<span id="spectrum-and-chromatogram"></span><h1>3.2. Spectrum and Chromatogram<a class="headerlink" href="#module-pymzml.spec" title="Permalink to this headline">¶</a></h1>
<p>The spectrum class offers a python object for mass spectrometry data.
The spectrum object holds the basic information of the spectrum and offers
methods to interrogate properties of the spectrum.
Data, i.e. mass over charge (m/z) and intensity decoding is performed on demand
and can be accessed via their properties, e.g. <a class="reference internal" href="#pymzml.spec.Spectrum.peaks" title="pymzml.spec.Spectrum.peaks"><code class="xref py py-attr docutils literal notranslate"><span class="pre">peaks</span></code></a>.</p>
<p>The Spectrum class is used in the <a class="reference internal" href="pymzml_run.html#pymzml.run.Reader" title="pymzml.run.Reader"><code class="xref py py-class docutils literal notranslate"><span class="pre">Reader</span></code></a> class.
There each spectrum is accessible as a spectrum object.</p>
<p>Theoretical spectra can also be created using the setter functions.
For example, m/z values, intensities, and peaks can be set by the
corresponding properties: <a class="reference internal" href="#pymzml.spec.Spectrum.mz" title="pymzml.spec.Spectrum.mz"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pymzml.spec.Spectrum.mz</span></code></a>,
<a class="reference internal" href="#pymzml.spec.Spectrum.i" title="pymzml.spec.Spectrum.i"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pymzml.spec.Spectrum.i</span></code></a>, <a class="reference internal" href="#pymzml.spec.Spectrum.peaks" title="pymzml.spec.Spectrum.peaks"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pymzml.spec.Spectrum.peaks</span></code></a>.</p>
<p>Similar to the spectrum class, the chromatogram class allows interrogation
with profile data (time, intensity) in an total ion chromatogram.</p>
<div class="section" id="spectrum">
<h2>3.2.1. Spectrum<a class="headerlink" href="#spectrum" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pymzml.spec.Spectrum">
<em class="property">class </em><code class="descclassname">pymzml.spec.</code><code class="descname">Spectrum</code><span class="sig-paren">(</span><em>element=None</em>, <em>measured_precision=5e-06</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymzml/spec.html#Spectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pymzml.spec.Spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Spectrum class which inherits from class <a class="reference internal" href="#pymzml.spec.MS_Spectrum" title="pymzml.spec.MS_Spectrum"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pymzml.spec.MS_Spectrum</span></code></a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>element</strong> (<em>xml.etree.ElementTree.Element</em>) – spectrum as xml element</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><strong>measured_precision</strong> (<em>float</em>) – in ppm, i.e. 5e-6 equals to 5 ppm.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="pymzml.spec.Spectrum.__getitem__">
<code class="descname">__getitem__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymzml/spec.html#Spectrum.__getitem__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pymzml.spec.Spectrum.__getitem__" title="Permalink to this definition">¶</a></dt>
<dd><p>Access spectrum XML information by tag name</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>accession</strong> (<em>str</em>) – name of the XML tag</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">value of the XML tag</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">value (float or str)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pymzml.spec.Spectrum.__add__">
<code class="descname">__add__</code><span class="sig-paren">(</span><em>other_spec</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymzml/spec.html#Spectrum.__add__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pymzml.spec.Spectrum.__add__" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds two pymzml spectra</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other_spec</strong> (<a class="reference internal" href="#pymzml.spec.Spectrum" title="pymzml.spec.Spectrum"><em>Spectrum</em></a>) – spectrum to add to the current spectrum</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">reference to the edited spectrum</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">self (<a class="reference internal" href="#pymzml.spec.Spectrum" title="pymzml.spec.Spectrum">Spectrum</a>)</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pymzml</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pymzml</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span> <span class="n">measuredPrescision</span> <span class="o">=</span> <span class="mf">20e-6</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_to_read</span> <span class="o">=</span> <span class="s2">&quot;../mzML_example_files/xy.mzML.gz&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">run</span> <span class="o">=</span> <span class="n">pymzml</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">Reader</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">file_to_read</span> <span class="p">,</span>
<span class="gp">... </span>    <span class="n">MS1_Precision</span> <span class="o">=</span> <span class="mf">5e-6</span> <span class="p">,</span>
<span class="gp">... </span>    <span class="n">MSn_Precision</span> <span class="o">=</span> <span class="mf">20e-6</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="n">run</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">s</span> <span class="o">+=</span> <span class="n">spec</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pymzml.spec.Spectrum.__sub__">
<code class="descname">__sub__</code><span class="sig-paren">(</span><em>other_spec</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymzml/spec.html#Spectrum.__sub__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pymzml.spec.Spectrum.__sub__" title="Permalink to this definition">¶</a></dt>
<dd><p>Subtracts two pymzml spectra.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other_spec</strong> (<a class="reference internal" href="#pymzml.spec.Spectrum" title="pymzml.spec.Spectrum"><em>spec.Spectrum</em></a>) – spectrum to subtract from the current
spectrum</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">returns self after other_spec was subtracted</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">self (<a class="reference internal" href="#pymzml.spec.Spectrum" title="pymzml.spec.Spectrum">spec.Spectrum</a>)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pymzml.spec.Spectrum.__mul__">
<code class="descname">__mul__</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymzml/spec.html#Spectrum.__mul__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pymzml.spec.Spectrum.__mul__" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiplies each intensity with a float, i.e. scales the spectrum.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>value</strong> (<em>int</em><em>, </em><em>float</em>) – value to multiply the intensities with</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="docutils">
<dt>returns self after intensities were scaled</dt>
<dd>by value</dd>
</dl>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">self (<a class="reference internal" href="#pymzml.spec.Spectrum" title="pymzml.spec.Spectrum">spec.Spectrum</a>)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pymzml.spec.Spectrum.__truediv__">
<code class="descname">__truediv__</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymzml/spec.html#Spectrum.__truediv__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pymzml.spec.Spectrum.__truediv__" title="Permalink to this definition">¶</a></dt>
<dd><p>Divides each intensity by a float, i.e. scales the spectrum.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>value</strong> (<em>int</em><em>, </em><em>float</em>) – value to divide the intensities by</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="docutils">
<dt>returns self after intensities were scaled</dt>
<dd>by value.</dd>
</dl>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">self (<a class="reference internal" href="#pymzml.spec.Spectrum" title="pymzml.spec.Spectrum">spec.Spectrum</a>)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pymzml.spec.Spectrum.ID">
<code class="descname">ID</code><a class="headerlink" href="#pymzml.spec.Spectrum.ID" title="Permalink to this definition">¶</a></dt>
<dd><p>Access the native id (last number in the id attribute) of the spectrum.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">native ID of the spectrum</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ID (str)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pymzml.spec.Spectrum.TIC">
<code class="descname">TIC</code><a class="headerlink" href="#pymzml.spec.Spectrum.TIC" title="Permalink to this definition">¶</a></dt>
<dd><p>Property to access the total ion current for this spectrum.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Total Ion Current of the spectrum.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">TIC (float)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pymzml.spec.Spectrum.estimated_noise_level">
<code class="descname">estimated_noise_level</code><span class="sig-paren">(</span><em>mode='median'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymzml/spec.html#Spectrum.estimated_noise_level"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pymzml.spec.Spectrum.estimated_noise_level" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates noise threshold for function remove_noise.</p>
<p>Different modes are available. Default is ‘median’</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><strong>mode</strong> (<em>str</em>) – define mode for removing noise. Default = “median”
(other modes: “mean”, “mad”)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">estimate noise threshold</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">noise_level (float)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pymzml.spec.Spectrum.extreme_values">
<code class="descname">extreme_values</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymzml/spec.html#Spectrum.extreme_values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pymzml.spec.Spectrum.extreme_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Find extreme values, minimal and maximum m/z and intensity</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>key</strong> (<em>str</em>) – m/z : “mz” or  intensity : “i”</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">tuple of minimal and maximum m/z or intensity</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">extrema (tuple)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pymzml.spec.Spectrum.get">
<code class="descname">get</code><span class="sig-paren">(</span><em>acc</em>, <em>default=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymzml/spec.html#Spectrum.get"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pymzml.spec.Spectrum.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Mimic dicts get function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>acc</strong> (<em>str</em>) – accession or obo tag to return</li>
<li><strong>default</strong> (<em>None</em><em>, </em><em>optional</em>) – default value if acc is not found</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pymzml.spec.Spectrum.has_overlapping_peak">
<code class="descname">has_overlapping_peak</code><span class="sig-paren">(</span><em>mz</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymzml/spec.html#Spectrum.has_overlapping_peak"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pymzml.spec.Spectrum.has_overlapping_peak" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if a spectrum has more than one peak for a given m/z value
and within the measured precision</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>mz</strong> (<em>float</em>) – m/z value which should be checked</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if a nearby peak is detected,
otherwise <code class="docutils literal notranslate"><span class="pre">False</span></code></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Boolean (bool)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pymzml.spec.Spectrum.has_peak">
<code class="descname">has_peak</code><span class="sig-paren">(</span><em>mz2find</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymzml/spec.html#Spectrum.has_peak"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pymzml.spec.Spectrum.has_peak" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if a Spectrum has a certain peak.
Requires a m/z value as input and returns a list of peaks if the m/z
value is found in the spectrum, otherwise <code class="docutils literal notranslate"><span class="pre">[]</span></code> is returned.
Every peak is a tuple of m/z and intensity.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Multiple peaks may be found, depending on the defined precisions</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>mz2find</strong> (<em>float</em>) – m/z value which should be found</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">list of m/z, i tuples</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">peaks (list)</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pymzml</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">example_file</span> <span class="o">=</span> <span class="s1">&#39;tests/data/example.mzML&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">run</span> <span class="o">=</span> <span class="n">pymzml</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">Reader</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">example_file</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">MS_precisions</span> <span class="o">=</span>  <span class="p">{</span>
<span class="gp">... </span>        <span class="mi">1</span> <span class="p">:</span> <span class="mf">5e-6</span><span class="p">,</span>
<span class="gp">... </span>        <span class="mi">2</span> <span class="p">:</span> <span class="mf">20e-6</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">spectrum</span> <span class="ow">in</span> <span class="n">run</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">spectrum</span><span class="o">.</span><span class="n">ms_level</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
<span class="gp">... </span>            <span class="n">peak_to_find</span> <span class="o">=</span> <span class="n">spectrum</span><span class="o">.</span><span class="n">has_peak</span><span class="p">(</span><span class="mf">1016.5404</span><span class="p">)</span>
<span class="gp">... </span>            <span class="nb">print</span><span class="p">(</span><span class="n">peak_to_find</span><span class="p">)</span>
<span class="go">[(1016.5404, 19141.735187697403)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pymzml.spec.Spectrum.highest_peaks">
<code class="descname">highest_peaks</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymzml/spec.html#Spectrum.highest_peaks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pymzml.spec.Spectrum.highest_peaks" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to retrieve the n-highest centroided peaks of the spectrum.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>n</strong> (<em>int</em>) – number of highest peaks to return.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">list mz, i tupls with n-highest</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">centroided peaks (list)</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">run</span> <span class="o">=</span> <span class="n">pymzml</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">Reader</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s2">&quot;tests/data/example.mzML.gz&quot;</span><span class="p">,</span>
<span class="gp">... </span>     <span class="n">MS_precisions</span> <span class="o">=</span>  <span class="p">{</span>
<span class="gp">... </span>        <span class="mi">1</span> <span class="p">:</span> <span class="mf">5e-6</span><span class="p">,</span>
<span class="gp">... </span>        <span class="mi">2</span> <span class="p">:</span> <span class="mf">20e-6</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">spectrum</span> <span class="ow">in</span> <span class="n">run</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">spectrum</span><span class="o">.</span><span class="n">ms_level</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="n">spectrum</span><span class="o">.</span><span class="n">ID</span> <span class="o">==</span> <span class="mi">1770</span><span class="p">:</span>
<span class="gp">... </span>            <span class="k">for</span> <span class="n">mz</span><span class="p">,</span><span class="n">i</span> <span class="ow">in</span> <span class="n">spectrum</span><span class="o">.</span><span class="n">highest_peaks</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
<span class="gp">... </span>               <span class="nb">print</span><span class="p">(</span><span class="n">mz</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pymzml.spec.Spectrum.i">
<code class="descname">i</code><a class="headerlink" href="#pymzml.spec.Spectrum.i" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the list of the intensity values.
If the intensity values are encoded, the function <code class="xref py py-func docutils literal notranslate"><span class="pre">_decode()</span></code>
is used to decode the encoded data.</p>
<p>The i property can also be set, e.g. for theoretical data. However,
it is recommended to use the peaks property to set mz and intensity
tuples at same time.</p>
<dl class="docutils">
<dt>Returns</dt>
<dd>i (list): list of intensity values from the analyzed spectrum</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="pymzml.spec.Spectrum.id_dict">
<code class="descname">id_dict</code><a class="headerlink" href="#pymzml.spec.Spectrum.id_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Access to all entries stored the id attribute of a spectrum.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">key value pairs for all entries in id attribute of a spectrum</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">id_dict (dict)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pymzml.spec.Spectrum.index">
<code class="descname">index</code><a class="headerlink" href="#pymzml.spec.Spectrum.index" title="Permalink to this definition">¶</a></dt>
<dd><p>Access the index of the spectrum.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">index of the spectrum</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">index (int)</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This does not necessarily correspond to the native spectrum ID</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pymzml.spec.Spectrum.measured_precision">
<code class="descname">measured_precision</code><a class="headerlink" href="#pymzml.spec.Spectrum.measured_precision" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the measured and internal precision</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">measured precision (e.g. 5e-6)</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">value (float)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pymzml.spec.Spectrum.ms_level">
<code class="descname">ms_level</code><a class="headerlink" href="#pymzml.spec.Spectrum.ms_level" title="Permalink to this definition">¶</a></dt>
<dd><p>Property to access the ms level.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ms_level (int)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pymzml.spec.Spectrum.mz">
<code class="descname">mz</code><a class="headerlink" href="#pymzml.spec.Spectrum.mz" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the list of m/z values. If the m/z values are encoded, the
function <code class="xref py py-func docutils literal notranslate"><span class="pre">_decode()</span></code> is used to decode the encoded data.
The mz property can also be set, e.g. for theoretical data.
However, it is recommended to use the peaks property to set mz and
intensity tuples at same time.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">list of m/z values of spectrum.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">mz (list)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pymzml.spec.Spectrum.peaks">
<code class="descname">peaks</code><span class="sig-paren">(</span><em>peak_type</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymzml/spec.html#Spectrum.peaks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pymzml.spec.Spectrum.peaks" title="Permalink to this definition">¶</a></dt>
<dd><p>Decode and return a list of mz/i tuples.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>peak_type</strong> (<em>str</em>) – currently supported types are:
raw, centroided and reprofiled</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">list or numpy array of mz/i tuples or arrays</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">peaks (list or ndarray)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pymzml.spec.Spectrum.ppm2abs">
<code class="descname">ppm2abs</code><span class="sig-paren">(</span><em>value</em>, <em>ppm_value</em>, <em>direction=1</em>, <em>factor=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymzml/spec.html#Spectrum.ppm2abs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pymzml.spec.Spectrum.ppm2abs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the value plus (or minus, dependent on direction) the
error (measured precision ) for this value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>value</strong> (<em>float</em>) – m/z value</li>
<li><strong>ppm_value</strong> (<em>int</em>) – ppm value</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><ul class="first simple">
<li><strong>direction</strong> (<em>int</em>) – plus or minus the considered m/z value.
The argument <em>direction</em> should be 1 or -1</li>
<li><strong>factor</strong> (<em>int</em>) – multiplication factor for the imprecision.
The argument <em>factor</em> should be bigger than 0</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">imprecision for the given value</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">imprecision (float)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pymzml.spec.Spectrum.reduce">
<code class="descname">reduce</code><span class="sig-paren">(</span><em>mz_range=(None</em>, <em>None)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymzml/spec.html#Spectrum.reduce"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pymzml.spec.Spectrum.reduce" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove all m/z values outside the given range.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>mz_range</strong> (<em>tuple</em>) – tuple of min, max values</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">list of mz, i tuples in the given range.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">peaks (list)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pymzml.spec.Spectrum.remove_noise">
<code class="descname">remove_noise</code><span class="sig-paren">(</span><em>mode='median'</em>, <em>noise_level=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymzml/spec.html#Spectrum.remove_noise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pymzml.spec.Spectrum.remove_noise" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to remove noise from peaks, centroided peaks and reprofiled
peaks.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><ul class="first simple">
<li><strong>mode</strong> (<em>str</em>) – define mode for removing noise. Default = “median”</li>
<li><strong>modes</strong> (<em>(</em><em>other</em>) – <p>“mean”, “mad”)</p>
<p>noise_level (float): noise threshold</p>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Returns a list with tuples of
m/z-intensity pairs above the noise threshold</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">reprofiled peaks (list)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pymzml.spec.Spectrum.scan_time">
<code class="descname">scan_time</code><a class="headerlink" href="#pymzml.spec.Spectrum.scan_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Property to access the retention time and retention time unit.
Please note, that we do not assume the retention time unit,
if it is not correctly defined in the mzML.
It is set to ‘unicorns’ in this case.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">scan_time_unit (str):</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">scan_time (float)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pymzml.spec.Spectrum.scan_time_in_minutes">
<code class="descname">scan_time_in_minutes</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymzml/spec.html#Spectrum.scan_time_in_minutes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pymzml.spec.Spectrum.scan_time_in_minutes" title="Permalink to this definition">¶</a></dt>
<dd><p>Property to access the retention time in minutes.
If the retention time unit is defined within the mzML,
the retention time is converted into minutes and returned
without the unit.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">scan_time (float)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pymzml.spec.Spectrum.selected_precursors">
<code class="descname">selected_precursors</code><a class="headerlink" href="#pymzml.spec.Spectrum.selected_precursors" title="Permalink to this definition">¶</a></dt>
<dd><p>Property to access the selected precursors of a MS2 spectrum. Returns
a list of dicts containing the precursors mz and, if available intensity
and charge for each precursor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">selected_precursors (list)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pymzml.spec.Spectrum.set_peaks">
<code class="descname">set_peaks</code><span class="sig-paren">(</span><em>peaks</em>, <em>peak_type</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymzml/spec.html#Spectrum.set_peaks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pymzml.spec.Spectrum.set_peaks" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign a custom peak array of type peak_type</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>peaks</strong> (<em>list</em><em> or </em><em>ndarray</em>) – list or array of mz/i values</li>
<li><strong>peak_type</strong> (<em>str</em>) – Either raw, centroided or reprofiled</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pymzml.spec.Spectrum.similarity_to">
<code class="descname">similarity_to</code><span class="sig-paren">(</span><em>spec2</em>, <em>round_precision=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymzml/spec.html#Spectrum.similarity_to"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pymzml.spec.Spectrum.similarity_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Compares two spectra and returns cosine</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>spec2</strong> (<a class="reference internal" href="#pymzml.spec.Spectrum" title="pymzml.spec.Spectrum"><em>Spectrum</em></a>) – another pymzml spectrum that is compared to the
current spectrum.</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><strong>round_precision</strong> (<em>int</em>) – precision mzs are rounded to, i.e. round( mz,
round_precision )</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><dl class="docutils">
<dt>value between 0 and 1, i.e. the cosine between the</dt>
<dd>two spectra.</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">cosine (float)</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Spectra data is transformed into an n-dimensional vector,
where m/z values are binned in bins of 10 m/z and the intensities
are added up. Then the cosine is calculated between those two
vectors. The more similar the specs are, the closer the value is
to 1.</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pymzml.spec.Spectrum.t_mz_set">
<code class="descname">t_mz_set</code><a class="headerlink" href="#pymzml.spec.Spectrum.t_mz_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a set of integers out of transformed m/z values
(including all values in the defined imprecision).
This is used to accelerate has_peak function and similar.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">set of transformed m/z values</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">t_mz_set (set)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pymzml.spec.Spectrum.transform_mz">
<code class="descname">transform_mz</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymzml/spec.html#Spectrum.transform_mz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pymzml.spec.Spectrum.transform_mz" title="Permalink to this definition">¶</a></dt>
<dd><p>pymzml uses an internal precision for different tasks. This precision
depends on the measured precision and is calculated when
<code class="xref py py-attr docutils literal notranslate"><span class="pre">spec.Spectrum.measured_precision</span></code> is invoked. transform_mz
can be used to transform m/z values into the internal standard.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>value</strong> (<em>float</em>) – m/z value</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">to internal standard transformed mz
value this value can be used to probe internal dictionaries,
lists or sets, e.g. <a class="reference internal" href="#pymzml.spec.Spectrum.t_mz_set" title="pymzml.spec.Spectrum.t_mz_set"><code class="xref py py-func docutils literal notranslate"><span class="pre">pymzml.spec.Spectrum.t_mz_set()</span></code></a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">transformed value (float)</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pymzml</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">run</span> <span class="o">=</span> <span class="n">pymzml</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">Reader</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s2">&quot;test.mzML.gz&quot;</span> <span class="p">,</span>
<span class="gp">... </span>    <span class="n">MS_precisions</span> <span class="o">=</span>  <span class="p">{</span>
<span class="gp">... </span>        <span class="mi">1</span> <span class="p">:</span> <span class="mf">5e-6</span><span class="p">,</span>
<span class="gp">... </span>        <span class="mi">2</span> <span class="p">:</span> <span class="mf">20e-6</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">spectrum</span> <span class="ow">in</span> <span class="n">run</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">spectrum</span><span class="o">.</span><span class="n">ms_level</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">peak_to_find</span> <span class="o">=</span> <span class="n">spectrum</span><span class="o">.</span><span class="n">has_deconvoluted_peak</span><span class="p">(</span>
<span class="gp">... </span>            <span class="mf">1044.5804</span>
<span class="gp">... </span>        <span class="p">)</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="n">peak_to_find</span><span class="p">)</span>
<span class="go">[(1044.5596, 3809.4356300564586)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pymzml.spec.Spectrum.transformed_mz_with_error">
<code class="descname">transformed_mz_with_error</code><a class="headerlink" href="#pymzml.spec.Spectrum.transformed_mz_with_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns transformed m/z value with error</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Transformed m/z values in dictionary<blockquote>
<div>{<p>m/z_with_error : [(m/z,intensity), …], …</p>
<p>}</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">tmz values (dict)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pymzml.spec.Spectrum.transformed_peaks">
<code class="descname">transformed_peaks</code><a class="headerlink" href="#pymzml.spec.Spectrum.transformed_peaks" title="Permalink to this definition">¶</a></dt>
<dd><p>m/z value is multiplied by the internal precision.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Returns a list of peaks (tuples of mz and
intensity).
Float m/z values are adjusted by the internal precision
to integers.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">Transformed peaks (list)</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="chromatogram">
<h2>3.2.2. Chromatogram<a class="headerlink" href="#chromatogram" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pymzml.spec.Chromatogram">
<em class="property">class </em><code class="descclassname">pymzml.spec.</code><code class="descname">Chromatogram</code><span class="sig-paren">(</span><em>element</em>, <em>measured_precision=5e-06</em>, <em>param=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymzml/spec.html#Chromatogram"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pymzml.spec.Chromatogram" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for Chromatogram access and handling.</p>
<dl class="method">
<dt id="pymzml.spec.Chromatogram.peaks">
<code class="descname">peaks</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymzml/spec.html#Chromatogram.peaks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pymzml.spec.Chromatogram.peaks" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the list of peaks of the spectrum as tuples (time, intensity).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">list of time, intensity tuples</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">peaks (list)</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pymzml</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">run</span> <span class="o">=</span> <span class="n">pymzml</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">Reader</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">spectra</span><span class="o">.</span><span class="n">mzMl</span><span class="o">.</span><span class="n">gz</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">MS_precisions</span> <span class="o">=</span>  <span class="p">{</span>
<span class="gp">... </span>        <span class="mi">1</span> <span class="p">:</span> <span class="mf">5e-6</span><span class="p">,</span>
<span class="gp">... </span>        <span class="mi">2</span> <span class="p">:</span> <span class="mf">20e-6</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">run</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">pymzml</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">Chromatogram</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">for</span> <span class="n">time</span><span class="p">,</span> <span class="n">intensity</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">peaks</span><span class="p">:</span>
<span class="gp">... </span>            <span class="nb">print</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">intensity</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The peaks property can also be set, e.g. for theoretical data.
It requires a list of time/intensity tuples.</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pymzml.spec.Chromatogram.profile">
<code class="descname">profile</code><a class="headerlink" href="#pymzml.spec.Chromatogram.profile" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the list of peaks of the chromatogram as tuples (time, intensity).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">list of time, i tuples</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">peaks (list)</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pymzml</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">run</span> <span class="o">=</span> <span class="n">pymzml</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">Reader</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">spectra</span><span class="o">.</span><span class="n">mzMl</span><span class="o">.</span><span class="n">gz</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">MS_precisions</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>        <span class="mi">1</span> <span class="p">:</span> <span class="mf">5e-6</span><span class="p">,</span>
<span class="gp">... </span>        <span class="mi">2</span> <span class="p">:</span> <span class="mf">20e-6</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">run</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">pymzml</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">Chromatogram</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">for</span> <span class="n">time</span><span class="p">,</span> <span class="n">intensity</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">peaks</span><span class="p">:</span>
<span class="gp">... </span>            <span class="nb">print</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">intensity</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The peaks property can also be set, e.g. for theoretical data.
It requires a list of time/intensity tuples.</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pymzml.spec.Chromatogram.time">
<code class="descname">time</code><a class="headerlink" href="#pymzml.spec.Chromatogram.time" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the list of time values. If the time values are encoded, the
function _decode() is used to decode the encoded data.</p>
<p>The time property can also be set, e.g. for theoretical data.
However, it is recommended to use the profile property to set time and
intensity tuples at same time.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">list of time values from the analyzed chromatogram</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">time (list)</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="ms-spectrum">
<h2>3.2.3. MS_Spectrum<a class="headerlink" href="#ms-spectrum" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pymzml.spec.MS_Spectrum">
<em class="property">class </em><code class="descclassname">pymzml.spec.</code><code class="descname">MS_Spectrum</code><a class="reference internal" href="_modules/pymzml/spec.html#MS_Spectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pymzml.spec.MS_Spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>General spectrum class for data handling.</p>
<dl class="method">
<dt id="pymzml.spec.MS_Spectrum.get_element_by_name">
<code class="descname">get_element_by_name</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymzml/spec.html#MS_Spectrum.get_element_by_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pymzml.spec.MS_Spectrum.get_element_by_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Get element from the original tree by it’s unit name.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<em>str</em>) – unit name of the mzml element.</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><strong>obo_version</strong> (<em>str</em><em>, </em><em>optional</em>) – obo version number.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pymzml.spec.MS_Spectrum.get_element_by_path">
<code class="descname">get_element_by_path</code><span class="sig-paren">(</span><em>hooks</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymzml/spec.html#MS_Spectrum.get_element_by_path"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pymzml.spec.MS_Spectrum.get_element_by_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Find elements in spectrum by its path.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>hooks</strong> (<em>list</em>) – list of parent elements for the target element.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">list of XML objects
found in the path</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">elements (list)</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<p>To access cvParam in scanWindow tag:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">spec</span><span class="o">.</span><span class="n">get_element_by_path</span><span class="p">([</span><span class="s1">&#39;scanList&#39;</span><span class="p">,</span> <span class="s1">&#39;scan&#39;</span><span class="p">,</span> <span class="s1">&#39;scanWindowList&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;scanWindow&#39;</span><span class="p">,</span> <span class="s1">&#39;cvParam&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pymzml.spec.MS_Spectrum.measured_precision">
<code class="descname">measured_precision</code><a class="headerlink" href="#pymzml.spec.MS_Spectrum.measured_precision" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the measured and internal precision.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">measured Precision (e.g. 5e-6)</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">value (float)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pymzml.spec.MS_Spectrum.precursors">
<code class="descname">precursors</code><a class="headerlink" href="#pymzml.spec.MS_Spectrum.precursors" title="Permalink to this definition">¶</a></dt>
<dd><p>List the precursor information of this spectrum, if available.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">list of precursor ids for this spectrum.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">precursor(list)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pymzml.spec.MS_Spectrum.to_string">
<code class="descname">to_string</code><span class="sig-paren">(</span><em>encoding='latin-1'</em>, <em>method='xml'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymzml/spec.html#MS_Spectrum.to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pymzml.spec.MS_Spectrum.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Return string representation of the xml element the
spectrum was initialized with.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><ul class="first simple">
<li><strong>encoding</strong> (<em>str</em>) – <p>text encoding of the returned string.</p>
<p>Default is latin-1.</p>
</li>
<li><strong>method</strong> (<em>str</em>) – <p>text format of the returned string.</p>
<p>Default is xml, alternatives are html and text.</p>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">xml string representation of the spectrum.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">element (str)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="pymzml_utils.html" class="btn btn-neutral float-right" title="3.3. Utils" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="pymzml_run.html" class="btn btn-neutral float-left" title="3.1. Main reader interface" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Kösters, M., Leufken, J., Schulze, S., Sugimoto, K., Zahedi, R. P., Hippler, M., Leidel, S. A. and Fufezan, C.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>